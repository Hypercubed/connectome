
<h4 class="title">Ligand Receptor Connectome</h4>
<p>A visual guide to FANTOM5 Ligand-Receptor interactions</p>

<p class="ng-cloak">
  Pairs: {{selected.pairs.length}} / {{data.pairs.length}}
  <br />Nodes: {{graphData.nodes.length}} / {{data.cells.length}}
  <br />Edges: {{graphData.edges.length}} / {{graphData.edgeCount}} <span class="bg-danger" ng-show="graphData.edgeCount > options.maxEdges">Maximum shown</span></span>
</p>

<accordion close-others="false">

  <accordion-group heading="Node Filters" is-open="panelState.nodeFilters" ng-class="{'collapsed': !panelState.nodeFilters}">

    <div panel heading="Samples" is-open="panelState.cells">
      <div panel-label>
        {{selected.cells.length}} / <a href ng-click="selected.cells = data.cells; $event.stopPropagation();">{{data.cells.length}}</a> <a href ng-click="selected.cells = []; $event.stopPropagation();">(clear)</a>
      </div>
      <select id="cells" class="col-md-12 form-control" size="30" multiple  chosen  display-selected-options="false" search-contains="true" ng-model="selected.cells" ng-options="c.name for c in data.cells track by c.id" data-placeholder="Select cell samples" style="width: 100%"></select>
    </div>

    <p />
    <div panel heading="Ligand rank" is-open="panelState.receptorRank" label="p = {{options.ligandRankFilter | number:2}}">
      <div slider ng-model="options.ligandRankFilter" max="1" min="0" step="0.01"></div>
    </div>
    
    <p />
    <div panel heading="Receptor rank" is-open="panelState.ligandRank" label="p = {{options.receptorRankFilter | number:2}}">
      <div slider ng-model="options.receptorRankFilter" max="1" min="0" step="0.01"></div>
    </div>

  </accordion-group>

  <accordion-group heading="Edge Filters" is-open="panelState.edgeFilters" ng-class="{'collapsed': !panelState.edgeFilters}">

    <div panel heading="Ligand - Receptor Pairs" is-open="panelState.pairs">
      <div panel-label>
        {{selected.pairs.length}} / <a href ng-click="selected.pairs = data.pairs; $event.stopPropagation();">{{data.pairs.length}}</a> <a href ng-click="selected.pairs = []; $event.stopPropagation();">(clear)</a>
      </div>
      <select id="pairs" class="col-md-12" size="30" multiple chosen  display-selected-options="false" search-contains="true" ng-model="selected.pairs" ng-options="p.Ligand + '-' + p.Receptor for p in data.pairs track by p.id" data-placeholder="Select Ligand-Receptor pairs"></select>
    </div>

    <p />
    <div panel heading="Ligand TPM" is-open="panelState.ligand" label="&gt; {{options.ligandFilter | number:0}} tpm">
      <div slider ng-model="options.ligandFilter" max="graphData.ligandExtent[1]" min="0"></div>
    </div>

    <p />
    <div panel heading="Receptor TPM" is-open="panelState.receptor" label="&gt; {{options.receptorFilter | number:0}} tpm">
      <div slider ng-model="options.receptorFilter" max="graphData.receptorExtent[1]" min="0"></div>
    </div>

    <p />
    <div panel heading="Edge rank" label="{{options.maxEdges | number:0}}" is-open="panelState.edges" >
      <div slider ng-model="options.maxEdges" max="1000" min="1"></div>
    </div>    
  </accordion-group>

  <accordion-group heading="Options" is-open="panelState.options" ng-class="{'collapsed': !panelState.options}">
    <div>
      Show node labels
      <div class="pull-right small"><input type="checkbox" ng-model="options.showLabels"></div>
    </div>
  </accordion-group>

  <accordion-group heading="Explanation" is-open="panelState.help" ng-class="{'collapsed': !panelState.help}">
    <ul>
      <li>Select Ligand - Receptor pair in the filter.
      <li>Select cell samples.
      <li>The top 100 edges for the selected cells will appear.
      <li>Hover over nodes and edges to get more information.
      <li>Click and drag nodes to move.
      <li>Double click a node to fix in place.  Double click again to release.
    </ul>

  </accordion-group>
</accordion>


